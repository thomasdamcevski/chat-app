import{r as pe,s as re,n as H,c as ge,x as je,o as Le,y as qe,t as Ue,e as Ne}from"../chunks/scheduler.z8iLth0v.js";import{k as W,S as oe,i as ae,m as se,g as O,d as p,e as y,s as E,c as w,a as T,f as I,y as F,o as S,h as g,z as B,A as U,B as Ee,t as z,b as J,j as ee,p as G,u as he,v as de,w as fe,l as X,n as Fe,x as me,q as We}from"../chunks/index.f5emdvso.js";import{w as Ie}from"../chunks/index.wgaSS33k.js";function ye(r){return(r==null?void 0:r.length)!==void 0?r:Array.from(r)}function Ve(r,e){r.d(1),e.delete(r.key)}function Be(r,e,t,n,s,i,o,a,h,u,l,c){let d=r.length,m=i.length,f=d;const C={};for(;f--;)C[r[f].key]=f;const v=[],b=new Map,N=new Map,M=[];for(f=m;f--;){const k=c(s,i,f),D=t(k);let q=o.get(D);q?n&&M.push(()=>q.p(k,e)):(q=u(D,k),q.c()),b.set(D,v[f]=q),D in C&&N.set(D,Math.abs(f-C[D]))}const P=new Set,L=new Set;function R(k){W(k,1),k.m(a,l),o.set(k.key,k),l=k.first,m--}for(;d&&m;){const k=v[m-1],D=r[d-1],q=k.key,Y=D.key;k===D?(l=k.first,d--,m--):b.has(Y)?!o.has(q)||P.has(q)?R(k):L.has(Y)?d--:N.get(q)>N.get(Y)?(L.add(q),R(k)):(P.add(Y),d--):(h(D,o),d--)}for(;d--;){const k=r[d];b.has(k.key)||h(k,o)}for(;m;)R(v[m-1]);return pe(M),v}new TextEncoder;function He({params:r}){return{title:"Hello world!",content:"Welcome to our blog. Lorem ipsum dolor sit amet..."}}const pn=Object.freeze(Object.defineProperty({__proto__:null,load:He},Symbol.toStringTag,{value:"Module"}));class A extends Error{constructor(e){var t,n,s,i;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,A.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof A||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(t=this.response)==null?void 0:t.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":(i=(s=(n=this.originalError)==null?void 0:n.cause)==null?void 0:s.message)!=null&&i.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong while processing your request.")}get data(){return this.response}toJSON(){return{...this}}}const Q=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function $e(r,e){const t={};if(typeof r!="string")return t;const n=Object.assign({},e||{}).decode||Ke;let s=0;for(;s<r.length;){const i=r.indexOf("=",s);if(i===-1)break;let o=r.indexOf(";",s);if(o===-1)o=r.length;else if(o<i){s=r.lastIndexOf(";",i-1)+1;continue}const a=r.slice(s,i).trim();if(t[a]===void 0){let h=r.slice(i+1,o).trim();h.charCodeAt(0)===34&&(h=h.slice(1,-1));try{t[a]=n(h)}catch{t[a]=h}}s=o+1}return t}function we(r,e,t){const n=Object.assign({},t||{}),s=n.encode||ze;if(!Q.test(r))throw new TypeError("argument name is invalid");const i=s(e);if(i&&!Q.test(i))throw new TypeError("argument val is invalid");let o=r+"="+i;if(n.maxAge!=null){const a=n.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(a)}if(n.domain){if(!Q.test(n.domain))throw new TypeError("option domain is invalid");o+="; Domain="+n.domain}if(n.path){if(!Q.test(n.path))throw new TypeError("option path is invalid");o+="; Path="+n.path}if(n.expires){if(!function(h){return Object.prototype.toString.call(h)==="[object Date]"||h instanceof Date}(n.expires)||isNaN(n.expires.valueOf()))throw new TypeError("option expires is invalid");o+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(o+="; HttpOnly"),n.secure&&(o+="; Secure"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():n.priority){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o}function Ke(r){return r.indexOf("%")!==-1?decodeURIComponent(r):r}function ze(r){return encodeURIComponent(r)}let De;function te(r){if(r)try{const e=decodeURIComponent(De(r.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function xe(r,e=0){let t=te(r);return!(Object.keys(t).length>0&&(!t.exp||t.exp-e>Date.now()/1e3))}De=typeof atob=="function"?atob:r=>{let e=String(r).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,n,s=0,i=0,o="";n=e.charAt(i++);~n&&(t=s%4?64*t+n:n,s++%4)?o+=String.fromCharCode(255&t>>(-2*s&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return o};const ve="pb_auth";class Je{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get model(){return this.baseModel}get isValid(){return!xe(this.token)}get isAdmin(){return te(this.token).type==="admin"}get isAuthRecord(){return te(this.token).type==="authRecord"}save(e,t){this.baseToken=e||"",this.baseModel=t||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,t=ve){const n=$e(e||"")[t]||"";let s={};try{s=JSON.parse(n),(typeof s===null||typeof s!="object"||Array.isArray(s))&&(s={})}catch{}this.save(s.token||"",s.model||null)}exportToCookie(e,t=ve){var h,u;const n={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},s=te(this.token);n.expires=s!=null&&s.exp?new Date(1e3*s.exp):new Date("1970-01-01"),e=Object.assign({},n,e);const i={token:this.token,model:this.model?JSON.parse(JSON.stringify(this.model)):null};let o=we(t,JSON.stringify(i),e);const a=typeof Blob<"u"?new Blob([o]).size:o.length;if(i.model&&a>4096){i.model={id:(h=i==null?void 0:i.model)==null?void 0:h.id,email:(u=i==null?void 0:i.model)==null?void 0:u.email};const l=["collectionId","username","verified"];for(const c in this.model)l.includes(c)&&(i.model[c]=this.model[c]);o=we(t,JSON.stringify(i),e)}return o}onChange(e,t=!1){return this._onChangeCallbacks.push(e),t&&e(this.token,this.model),()=>{for(let n=this._onChangeCallbacks.length-1;n>=0;n--)if(this._onChangeCallbacks[n]==e)return delete this._onChangeCallbacks[n],void this._onChangeCallbacks.splice(n,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.model)}}class Xe extends Je{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get model(){return(this._storageGet(this.storageKey)||{}).model||null}save(e,t){this._storageSet(this.storageKey,{token:e,model:t}),super.save(e,t)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&(window!=null&&window.localStorage)){const t=window.localStorage.getItem(e)||"";try{return JSON.parse(t)}catch{return t}}return this.storageFallback[e]}_storageSet(e,t){if(typeof window<"u"&&(window!=null&&window.localStorage)){let n=t;typeof t!="string"&&(n=JSON.stringify(t)),window.localStorage.setItem(e,n)}else this.storageFallback[e]=t}_storageRemove(e){var t;typeof window<"u"&&(window!=null&&window.localStorage)&&((t=window.localStorage)==null||t.removeItem(e)),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const t=this._storageGet(this.storageKey)||{};super.save(t.token||"",t.model||null)})}}class V{constructor(e){this.client=e}}class Ye extends V{async getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}async update(e,t){return t=Object.assign({method:"PATCH",body:e},t),this.client.send("/api/settings",t)}async testS3(e="storage",t){return t=Object.assign({method:"POST",body:{filesystem:e}},t),this.client.send("/api/settings/test/s3",t).then(()=>!0)}async testEmail(e,t,n){return n=Object.assign({method:"POST",body:{email:e,template:t}},n),this.client.send("/api/settings/test/email",n).then(()=>!0)}async generateAppleClientSecret(e,t,n,s,i,o){return o=Object.assign({method:"POST",body:{clientId:e,teamId:t,keyId:n,privateKey:s,duration:i}},o),this.client.send("/api/settings/apple/generate-client-secret",o)}}class be extends V{decode(e){return e}async getFullList(e,t){if(typeof e=="number")return this._getFullList(e,t);let n=500;return(t=Object.assign({},e,t)).batch&&(n=t.batch,delete t.batch),this._getFullList(n,t)}async getList(e=1,t=30,n){return(n=Object.assign({method:"GET"},n)).query=Object.assign({page:e,perPage:t},n.query),this.client.send(this.baseCrudPath,n).then(s=>{var i;return s.items=((i=s.items)==null?void 0:i.map(o=>this.decode(o)))||[],s})}async getFirstListItem(e,t){return(t=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},t)).query=Object.assign({filter:e,skipTotal:1},t.query),this.getList(1,1,t).then(n=>{var s;if(!((s=n==null?void 0:n.items)!=null&&s.length))throw new A({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return n.items[0]})}async getOne(e,t){if(!e)throw new A({url:this.client.buildUrl(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(n=>this.decode(n))}async create(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send(this.baseCrudPath,t).then(n=>this.decode(n))}async update(e,t,n){return n=Object.assign({method:"PATCH",body:t},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),n).then(s=>this.decode(s))}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(()=>!0)}_getFullList(e=500,t){(t=t||{}).query=Object.assign({skipTotal:1},t.query);let n=[],s=async i=>this.getList(i,e||500,t).then(o=>{const a=o.items;return n=n.concat(a),a.length==o.perPage?s(i+1):n});return s(1)}}function x(r,e,t,n){const s=n!==void 0;return s||t!==void 0?s?(console.warn(r),e.body=Object.assign({},e.body,t),e.query=Object.assign({},e.query,n),e):Object.assign(e,t):e}function le(r){var e;(e=r._resetAutoRefresh)==null||e.call(r)}class Ge extends be{get baseCrudPath(){return"/api/admins"}async update(e,t,n){return super.update(e,t,n).then(s=>{var i,o;return((i=this.client.authStore.model)==null?void 0:i.id)===s.id&&((o=this.client.authStore.model)==null?void 0:o.collectionId)===void 0&&this.client.authStore.save(this.client.authStore.token,s),s})}async delete(e,t){return super.delete(e,t).then(n=>{var s,i;return n&&((s=this.client.authStore.model)==null?void 0:s.id)===e&&((i=this.client.authStore.model)==null?void 0:i.collectionId)===void 0&&this.client.authStore.clear(),n})}authResponse(e){const t=this.decode((e==null?void 0:e.admin)||{});return e!=null&&e.token&&(e!=null&&e.admin)&&this.client.authStore.save(e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",admin:t})}async authWithPassword(e,t,n,s){let i={method:"POST",body:{identity:e,password:t}};i=x("This form of authWithPassword(email, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(email, pass, options?).",i,n,s);const o=i.autoRefreshThreshold;delete i.autoRefreshThreshold,i.autoRefresh||le(this.client);let a=await this.client.send(this.baseCrudPath+"/auth-with-password",i);return a=this.authResponse(a),o&&function(u,l,c,d){le(u);const m=u.beforeSend,f=u.authStore.model,C=u.authStore.onChange((v,b)=>{(!v||(b==null?void 0:b.id)!=(f==null?void 0:f.id)||(b!=null&&b.collectionId||f!=null&&f.collectionId)&&(b==null?void 0:b.collectionId)!=(f==null?void 0:f.collectionId))&&le(u)});u._resetAutoRefresh=function(){C(),u.beforeSend=m,delete u._resetAutoRefresh},u.beforeSend=async(v,b)=>{var L;const N=u.authStore.token;if((L=b.query)!=null&&L.autoRefresh)return m?m(v,b):{url:v,sendOptions:b};let M=u.authStore.isValid;if(M&&xe(u.authStore.token,l))try{await c()}catch{M=!1}M||await d();const P=b.headers||{};for(let R in P)if(R.toLowerCase()=="authorization"&&N==P[R]&&u.authStore.token){P[R]=u.authStore.token;break}return b.headers=P,m?m(v,b):{url:v,sendOptions:b}}}(this.client,o,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,t,Object.assign({autoRefresh:!0},i))),a}async authRefresh(e,t){let n={method:"POST"};return n=x("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",n,e,t),this.client.send(this.baseCrudPath+"/auth-refresh",n).then(this.authResponse.bind(this))}async requestPasswordReset(e,t,n){let s={method:"POST",body:{email:e}};return s=x("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",s,t,n),this.client.send(this.baseCrudPath+"/request-password-reset",s).then(()=>!0)}async confirmPasswordReset(e,t,n,s,i){let o={method:"POST",body:{token:e,password:t,passwordConfirm:n}};return o=x("This form of confirmPasswordReset(resetToken, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(resetToken, password, passwordConfirm, options?).",o,s,i),this.client.send(this.baseCrudPath+"/confirm-password-reset",o).then(()=>!0)}}const Qe=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function Ae(r){if(r){r.query=r.query||{};for(let e in r)Qe.includes(e)||(r.query[e]=r[e],delete r[e])}}class Re extends V{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,t,n){var o;if(!e)throw new Error("topic must be set.");let s=e;if(n){Ae(n);const a="options="+encodeURIComponent(JSON.stringify({query:n.query,headers:n.headers}));s+=(s.includes("?")?"&":"?")+a}const i=function(a){const h=a;let u;try{u=JSON.parse(h==null?void 0:h.data)}catch{}t(u||{})};return this.subscriptions[s]||(this.subscriptions[s]=[]),this.subscriptions[s].push(i),this.isConnected?this.subscriptions[s].length===1?await this.submitSubscriptions():(o=this.eventSource)==null||o.addEventListener(s,i):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,i)}async unsubscribe(e){var n;let t=!1;if(e){const s=this.getSubscriptionsByTopic(e);for(let i in s)if(this.hasSubscriptionListeners(i)){for(let o of this.subscriptions[i])(n=this.eventSource)==null||n.removeEventListener(i,o);delete this.subscriptions[i],t||(t=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?t&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){var n;let t=!1;for(let s in this.subscriptions)if((s+"?").startsWith(e)){t=!0;for(let i of this.subscriptions[s])(n=this.eventSource)==null||n.removeEventListener(s,i);delete this.subscriptions[s]}t&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,t){var i;let n=!1;const s=this.getSubscriptionsByTopic(e);for(let o in s){if(!Array.isArray(this.subscriptions[o])||!this.subscriptions[o].length)continue;let a=!1;for(let h=this.subscriptions[o].length-1;h>=0;h--)this.subscriptions[o][h]===t&&(a=!0,delete this.subscriptions[o][h],this.subscriptions[o].splice(h,1),(i=this.eventSource)==null||i.removeEventListener(o,t));a&&(this.subscriptions[o].length||delete this.subscriptions[o],n||this.hasSubscriptionListeners(o)||(n=!0))}this.hasSubscriptionListeners()?n&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){var t,n;if(this.subscriptions=this.subscriptions||{},e)return!!((t=this.subscriptions[e])!=null&&t.length);for(let s in this.subscriptions)if((n=this.subscriptions[s])!=null&&n.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!(e!=null&&e.isAbort))throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){const t={};e=e.includes("?")?e:e+"?";for(let n in this.subscriptions)(n+"?").startsWith(e)&&(t[n]=this.subscriptions[n]);return t}getNonEmptySubscriptionKeys(){const e=[];for(let t in this.subscriptions)this.subscriptions[t].length&&e.push(t);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.addEventListener(e,t)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.removeEventListener(e,t)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,t)=>{this.pendingConnects.push({resolve:e,reject:t}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildUrl("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const t=e;this.clientId=t==null?void 0:t.lastEventId,this.submitSubscriptions().then(async()=>{let n=3;for(;this.hasUnsentSubscriptions()&&n>0;)n--,await this.submitSubscriptions()}).then(()=>{for(let s of this.pendingConnects)s.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const n=this.getSubscriptionsByTopic("PB_CONNECT");for(let s in n)for(let i of n[s])i(e)}).catch(n=>{this.clientId="",this.connectErrorHandler(n)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(const t of e)if(!this.lastSentSubscriptions.includes(t))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let n of this.pendingConnects)n.reject(new A(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const t=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},t)}disconnect(e=!1){var t;if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(t=this.eventSource)==null||t.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let n of this.pendingConnects)n.resolve();this.pendingConnects=[]}}}class Ze extends be{constructor(e,t){super(e),this.collectionIdOrName=t}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}async subscribe(e,t,n){if(!e)throw new Error("Missing topic.");if(!t)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,t,n)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(e,t){if(typeof e=="number")return super.getFullList(e,t);const n=Object.assign({},e,t);return super.getFullList(n)}async getList(e=1,t=30,n){return super.getList(e,t,n)}async getFirstListItem(e,t){return super.getFirstListItem(e,t)}async getOne(e,t){return super.getOne(e,t)}async create(e,t){return super.create(e,t)}async update(e,t,n){return super.update(e,t,n).then(s=>{var i,o,a;return((i=this.client.authStore.model)==null?void 0:i.id)!==(s==null?void 0:s.id)||((o=this.client.authStore.model)==null?void 0:o.collectionId)!==this.collectionIdOrName&&((a=this.client.authStore.model)==null?void 0:a.collectionName)!==this.collectionIdOrName||this.client.authStore.save(this.client.authStore.token,s),s})}async delete(e,t){return super.delete(e,t).then(n=>{var s,i,o;return!n||((s=this.client.authStore.model)==null?void 0:s.id)!==e||((i=this.client.authStore.model)==null?void 0:i.collectionId)!==this.collectionIdOrName&&((o=this.client.authStore.model)==null?void 0:o.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),n})}authResponse(e){const t=this.decode((e==null?void 0:e.record)||{});return this.client.authStore.save(e==null?void 0:e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",record:t})}async listAuthMethods(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e).then(t=>Object.assign({},t,{usernamePassword:!!(t!=null&&t.usernamePassword),emailPassword:!!(t!=null&&t.emailPassword),authProviders:Array.isArray(t==null?void 0:t.authProviders)?t==null?void 0:t.authProviders:[]}))}async authWithPassword(e,t,n,s){let i={method:"POST",body:{identity:e,password:t}};return i=x("This form of authWithPassword(usernameOrEmail, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(usernameOrEmail, pass, options?).",i,n,s),this.client.send(this.baseCollectionPath+"/auth-with-password",i).then(o=>this.authResponse(o))}async authWithOAuth2Code(e,t,n,s,i,o,a){let h={method:"POST",body:{provider:e,code:t,codeVerifier:n,redirectUrl:s,createData:i}};return h=x("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, options?).",h,o,a),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",h).then(u=>this.authResponse(u))}async authWithOAuth2(...e){if(e.length>1||typeof(e==null?void 0:e[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((e==null?void 0:e[0])||"",(e==null?void 0:e[1])||"",(e==null?void 0:e[2])||"",(e==null?void 0:e[3])||"",(e==null?void 0:e[4])||{},(e==null?void 0:e[5])||{},(e==null?void 0:e[6])||{});const t=(e==null?void 0:e[0])||{},n=(await this.listAuthMethods()).authProviders.find(h=>h.name===t.provider);if(!n)throw new A(new Error(`Missing or invalid provider "${t.provider}".`));const s=this.client.buildUrl("/api/oauth2-redirect"),i=new Re(this.client);let o=null;function a(){o==null||o.close(),i.unsubscribe()}return t.urlCallback||(o=Se(void 0)),new Promise(async(h,u)=>{var l;try{await i.subscribe("@oauth2",async f=>{const C=i.clientId;try{if(!f.state||C!==f.state)throw new Error("State parameters don't match.");const v=Object.assign({},t);delete v.provider,delete v.scopes,delete v.createData,delete v.urlCallback;const b=await this.authWithOAuth2Code(n.name,f.code,n.codeVerifier,s,t.createData,v);h(b)}catch(v){u(new A(v))}a()});const c={state:i.clientId};(l=t.scopes)!=null&&l.length&&(c.scope=t.scopes.join(" "));const d=this._replaceQueryParams(n.authUrl+s,c);await(t.urlCallback||function(f){o?o.location.href=f:o=Se(f)})(d)}catch(c){a(),u(new A(c))}})}async authRefresh(e,t){let n={method:"POST"};return n=x("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",n,e,t),this.client.send(this.baseCollectionPath+"/auth-refresh",n).then(s=>this.authResponse(s))}async requestPasswordReset(e,t,n){let s={method:"POST",body:{email:e}};return s=x("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",s,t,n),this.client.send(this.baseCollectionPath+"/request-password-reset",s).then(()=>!0)}async confirmPasswordReset(e,t,n,s,i){let o={method:"POST",body:{token:e,password:t,passwordConfirm:n}};return o=x("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",o,s,i),this.client.send(this.baseCollectionPath+"/confirm-password-reset",o).then(()=>!0)}async requestVerification(e,t,n){let s={method:"POST",body:{email:e}};return s=x("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",s,t,n),this.client.send(this.baseCollectionPath+"/request-verification",s).then(()=>!0)}async confirmVerification(e,t,n){let s={method:"POST",body:{token:e}};return s=x("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",s,t,n),this.client.send(this.baseCollectionPath+"/confirm-verification",s).then(()=>!0)}async requestEmailChange(e,t,n){let s={method:"POST",body:{newEmail:e}};return s=x("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",s,t,n),this.client.send(this.baseCollectionPath+"/request-email-change",s).then(()=>!0)}async confirmEmailChange(e,t,n,s){let i={method:"POST",body:{token:e,password:t}};return i=x("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",i,n,s),this.client.send(this.baseCollectionPath+"/confirm-email-change",i).then(()=>!0)}async listExternalAuths(e,t){return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths",t)}async unlinkExternalAuth(e,t,n){return n=Object.assign({method:"DELETE"},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths/"+encodeURIComponent(t),n).then(()=>!0)}_replaceQueryParams(e,t={}){let n=e,s="";e.indexOf("?")>=0&&(n=e.substring(0,e.indexOf("?")),s=e.substring(e.indexOf("?")+1));const i={},o=s.split("&");for(const a of o){if(a=="")continue;const h=a.split("=");i[decodeURIComponent(h[0].replace(/\+/g," "))]=decodeURIComponent((h[1]||"").replace(/\+/g," "))}for(let a in t)t.hasOwnProperty(a)&&(t[a]==null?delete i[a]:i[a]=t[a]);s="";for(let a in i)i.hasOwnProperty(a)&&(s!=""&&(s+="&"),s+=encodeURIComponent(a.replace(/%20/g,"+"))+"="+encodeURIComponent(i[a].replace(/%20/g,"+")));return s!=""?n+"?"+s:n}}function Se(r){if(typeof window>"u"||!(window!=null&&window.open))throw new A(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,t=768,n=window.innerWidth,s=window.innerHeight;e=e>n?n:e,t=t>s?s:t;let i=n/2-e/2,o=s/2-t/2;return window.open(r,"popup_window","width="+e+",height="+t+",top="+o+",left="+i+",resizable,menubar=no")}class et extends be{get baseCrudPath(){return"/api/collections"}async import(e,t=!1,n){return n=Object.assign({method:"PUT",body:{collections:e,deleteMissing:t}},n),this.client.send(this.baseCrudPath+"/import",n).then(()=>!0)}}class tt extends V{async getList(e=1,t=30,n){return(n=Object.assign({method:"GET"},n)).query=Object.assign({page:e,perPage:t},n.query),this.client.send("/api/logs",n)}async getOne(e,t){if(!e)throw new A({url:this.client.buildUrl("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/"+encodeURIComponent(e),t)}async getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}}class nt extends V{async check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class st extends V{getUrl(e,t,n={}){if(!t||!(e!=null&&e.id)||!(e!=null&&e.collectionId)&&!(e!=null&&e.collectionName))return"";const s=[];s.push("api"),s.push("files"),s.push(encodeURIComponent(e.collectionId||e.collectionName)),s.push(encodeURIComponent(e.id)),s.push(encodeURIComponent(t));let i=this.client.buildUrl(s.join("/"));if(Object.keys(n).length){n.download===!1&&delete n.download;const o=new URLSearchParams(n);i+=(i.includes("?")?"&":"?")+o}return i}async getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(t=>(t==null?void 0:t.token)||"")}}class it extends V{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}async create(e,t){return t=Object.assign({method:"POST",body:{name:e}},t),this.client.send("/api/backups",t).then(()=>!0)}async upload(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send("/api/backups/upload",t).then(()=>!0)}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}`,t).then(()=>!0)}async restore(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,t).then(()=>!0)}getDownloadUrl(e,t){return this.client.buildUrl(`/api/backups/${encodeURIComponent(t)}?token=${encodeURIComponent(e)}`)}}class rt{constructor(e="/",t,n="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseUrl=e,this.lang=n,this.authStore=t||new Xe,this.admins=new Ge(this),this.collections=new et(this),this.files=new st(this),this.logs=new tt(this),this.settings=new Ye(this),this.realtime=new Re(this),this.health=new nt(this),this.backups=new it(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new Ze(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,t){if(!t)return e;for(let n in t){let s=t[n];switch(typeof s){case"boolean":case"number":s=""+s;break;case"string":s="'"+s.replace(/'/g,"\\'")+"'";break;default:s=s===null?"null":s instanceof Date?"'"+s.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(s).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+n+"}",s)}return e}getFileUrl(e,t,n={}){return this.files.getUrl(e,t,n)}buildUrl(e){var n;let t=this.baseUrl;return typeof window>"u"||!window.location||t.startsWith("https://")||t.startsWith("http://")||(t=(n=window.location.origin)!=null&&n.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseUrl.startsWith("/")||(t+=window.location.pathname||"/",t+=t.endsWith("/")?"":"/"),t+=this.baseUrl),e&&(t+=t.endsWith("/")?"":"/",t+=e.startsWith("/")?e.substring(1):e),t}async send(e,t){t=this.initSendOptions(e,t);let n=this.buildUrl(e);if(this.beforeSend){const s=Object.assign({},await this.beforeSend(n,t));s.url!==void 0||s.options!==void 0?(n=s.url||n,t=s.options||t):Object.keys(s).length&&(t=s,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(t.query!==void 0){const s=this.serializeQueryParams(t.query);s&&(n+=(n.includes("?")?"&":"?")+s),delete t.query}return this.getHeader(t.headers,"Content-Type")=="application/json"&&t.body&&typeof t.body!="string"&&(t.body=JSON.stringify(t.body)),(t.fetch||fetch)(n,t).then(async s=>{let i={};try{i=await s.json()}catch{}if(this.afterSend&&(i=await this.afterSend(s,i)),s.status>=400)throw new A({url:s.url,status:s.status,data:i});return i}).catch(s=>{throw new A(s)})}initSendOptions(e,t){if((t=Object.assign({method:"GET"},t)).body=this.convertToFormDataIfNeeded(t.body),Ae(t),t.query=Object.assign({},t.params,t.query),t.requestKey===void 0&&(t.$autoCancel===!1||t.query.$autoCancel===!1?t.requestKey=null:(t.$cancelKey||t.query.$cancelKey)&&(t.requestKey=t.$cancelKey||t.query.$cancelKey)),delete t.$autoCancel,delete t.query.$autoCancel,delete t.$cancelKey,delete t.query.$cancelKey,this.getHeader(t.headers,"Content-Type")!==null||this.isFormData(t.body)||(t.headers=Object.assign({},t.headers,{"Content-Type":"application/json"})),this.getHeader(t.headers,"Accept-Language")===null&&(t.headers=Object.assign({},t.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(t.headers,"Authorization")===null&&(t.headers=Object.assign({},t.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&t.requestKey!==null){const n=t.requestKey||(t.method||"GET")+e;delete t.requestKey,this.cancelRequest(n);const s=new AbortController;this.cancelControllers[n]=s,t.signal=s.signal}return t}convertToFormDataIfNeeded(e){if(typeof FormData>"u"||e===void 0||typeof e!="object"||e===null||this.isFormData(e)||!this.hasBlobField(e))return e;const t=new FormData;for(let n in e){const s=this.normalizeFormDataValue(e[n]),i=Array.isArray(s)?s:[s];if(i.length)for(const o of i)t.append(n,o);else t.append(n,"")}return t}normalizeFormDataValue(e){return e===null||typeof e!="object"||e instanceof Date||this.hasBlobField({data:e})||Array.isArray(e)&&!e.filter(t=>typeof t!="string").length?e:JSON.stringify(e)}hasBlobField(e){for(let t in e){const n=Array.isArray(e[t])?e[t]:[e[t]];for(let s of n)if(typeof Blob<"u"&&s instanceof Blob||typeof File<"u"&&s instanceof File)return!0}return!1}getHeader(e,t){e=e||{},t=t.toLowerCase();for(let n in e)if(n.toLowerCase()==t)return e[n];return null}isFormData(e){return e&&(e.constructor.name==="FormData"||typeof FormData<"u"&&e instanceof FormData)}serializeQueryParams(e){const t=[];for(const n in e){if(e[n]===null)continue;const s=e[n],i=encodeURIComponent(n);if(Array.isArray(s))for(const o of s)t.push(i+"="+encodeURIComponent(o));else s instanceof Date?t.push(i+"="+encodeURIComponent(s.toISOString())):typeof s!==null&&typeof s=="object"?t.push(i+"="+encodeURIComponent(JSON.stringify(s))):t.push(i+"="+encodeURIComponent(s))}return t.join("&")}}const ot="https://complex-important.pockethost.io/",j=new rt(ot),ce=Ie(j.authStore.model);j.authStore.onChange(r=>{console.log("user changed",r),ce.set(j.authStore.model)});function at(r){let e,t,n,s,i,o,a="Sign up",h,u,l="Login",c,d;return{c(){e=y("form"),t=y("input"),n=E(),s=y("input"),i=E(),o=y("button"),o.textContent=a,h=E(),u=y("button"),u.textContent=l,this.h()},l(m){e=w(m,"FORM",{});var f=T(e);t=w(f,"INPUT",{placeholder:!0,type:!0}),n=I(f),s=w(f,"INPUT",{placeholder:!0,type:!0}),i=I(f),o=w(f,"BUTTON",{"data-svelte-h":!0}),F(o)!=="svelte-2kyflq"&&(o.textContent=a),h=I(f),u=w(f,"BUTTON",{"data-svelte-h":!0}),F(u)!=="svelte-nja564"&&(u.textContent=l),f.forEach(p),this.h()},h(){S(t,"placeholder","Username"),S(t,"type","text"),S(s,"placeholder","Password"),S(s,"type","password")},m(m,f){O(m,e,f),g(e,t),B(t,r[0]),g(e,n),g(e,s),B(s,r[1]),g(e,i),g(e,o),g(e,h),g(e,u),c||(d=[U(t,"input",r[7]),U(s,"input",r[8]),U(o,"click",r[4]),U(u,"click",r[3]),U(e,"submit",Ee(r[6]))],c=!0)},p(m,f){f&1&&t.value!==m[0]&&B(t,m[0]),f&2&&s.value!==m[1]&&B(s,m[1])},d(m){m&&p(e),c=!1,pe(d)}}}function ct(r){let e,t,n=r[2].username+"",s,i,o,a="Logout",h,u;return{c(){e=y("h1"),t=z("Logged in as "),s=z(n),i=E(),o=y("button"),o.textContent=a},l(l){e=w(l,"H1",{});var c=T(e);t=J(c,"Logged in as "),s=J(c,n),c.forEach(p),i=I(l),o=w(l,"BUTTON",{"data-svelte-h":!0}),F(o)!=="svelte-hd9vso"&&(o.textContent=a)},m(l,c){O(l,e,c),g(e,t),g(e,s),O(l,i,c),O(l,o,c),h||(u=U(o,"click",r[5]),h=!0)},p(l,c){c&4&&n!==(n=l[2].username+"")&&ee(s,n)},d(l){l&&(p(e),p(i),p(o)),h=!1,u()}}}function lt(r){let e;function t(i,o){return i[2]?ct:at}let n=t(r),s=n(r);return{c(){s.c(),e=se()},l(i){s.l(i),e=se()},m(i,o){s.m(i,o),O(i,e,o)},p(i,[o]){n===(n=t(i))&&s?s.p(i,o):(s.d(1),s=n(i),s&&(s.c(),s.m(e.parentNode,e)))},i:H,o:H,d(i){i&&p(e),s.d(i)}}}function ut(r,e,t){let n;ge(r,ce,d=>t(2,n=d));let s,i;async function o(){await j.collection("users").authWithPassword(s,i)}async function a(){const d={username:s,emailVisibility:!0,password:i,passwordConfirm:i};await j.collection("users").create(d),await o()}async function h(){await j.authStore.clear()}function u(d){je.call(this,r,d)}function l(){s=this.value,t(0,s)}function c(){i=this.value,t(1,i)}return[s,i,n,o,a,h,u,l,c]}class ht extends oe{constructor(e){super(),ae(this,e,ut,lt,re,{})}}const ie=Ie(!1);function _(r){const e=Object.prototype.toString.call(r);return r instanceof Date||typeof r=="object"&&e==="[object Date]"?new r.constructor(+r):typeof r=="number"||e==="[object Number]"||typeof r=="string"||e==="[object String]"?new Date(r):new Date(NaN)}const Z=43200,Ce=1440;let dt={};function ft(){return dt}function ke(r){const e=_(r),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+r-+t}function ne(r,e){const t=_(r),n=_(e),s=t.getTime()-n.getTime();return s<0?-1:s>0?1:s}function mt(r,e){const t=_(r),n=_(e),s=t.getFullYear()-n.getFullYear(),i=t.getMonth()-n.getMonth();return s*12+i}function pt(r){return e=>{const n=(r?Math[r]:Math.trunc)(e);return n===0?0:n}}function gt(r,e){return+_(r)-+_(e)}function bt(r){const e=_(r);return e.setHours(23,59,59,999),e}function yt(r){const e=_(r),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function wt(r){const e=_(r);return+bt(e)==+yt(e)}function vt(r,e){const t=_(r),n=_(e),s=ne(t,n),i=Math.abs(mt(t,n));let o;if(i<1)o=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-s*i);let a=ne(t,n)===-s;wt(_(r))&&i===1&&ne(r,n)===1&&(a=!1),o=s*(i-Number(a))}return o===0?0:o}function St(r,e,t){const n=gt(r,e)/1e3;return pt(t==null?void 0:t.roundingMethod)(n)}const Ct={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},kt=(r,e,t)=>{let n;const s=Ct[r];return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+n:n+" ago":n};function ue(r){return(e={})=>{const t=e.width?String(e.width):r.defaultWidth;return r.formats[t]||r.formats[r.defaultWidth]}}const Pt={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Tt={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Ot={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},_t={date:ue({formats:Pt,defaultWidth:"full"}),time:ue({formats:Tt,defaultWidth:"full"}),dateTime:ue({formats:Ot,defaultWidth:"full"})},Mt={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Et=(r,e,t,n)=>Mt[r];function $(r){return(e,t)=>{const n=t!=null&&t.context?String(t.context):"standalone";let s;if(n==="formatting"&&r.formattingValues){const o=r.defaultFormattingWidth||r.defaultWidth,a=t!=null&&t.width?String(t.width):o;s=r.formattingValues[a]||r.formattingValues[o]}else{const o=r.defaultWidth,a=t!=null&&t.width?String(t.width):r.defaultWidth;s=r.values[a]||r.values[o]}const i=r.argumentCallback?r.argumentCallback(e):e;return s[i]}}const It={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Dt={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},xt={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},At={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Rt={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},jt={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Lt=(r,e)=>{const t=Number(r),n=t%100;if(n>20||n<10)switch(n%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},qt={ordinalNumber:Lt,era:$({values:It,defaultWidth:"wide"}),quarter:$({values:Dt,defaultWidth:"wide",argumentCallback:r=>r-1}),month:$({values:xt,defaultWidth:"wide"}),day:$({values:At,defaultWidth:"wide"}),dayPeriod:$({values:Rt,defaultWidth:"wide",formattingValues:jt,defaultFormattingWidth:"wide"})};function K(r){return(e,t={})=>{const n=t.width,s=n&&r.matchPatterns[n]||r.matchPatterns[r.defaultMatchWidth],i=e.match(s);if(!i)return null;const o=i[0],a=n&&r.parsePatterns[n]||r.parsePatterns[r.defaultParseWidth],h=Array.isArray(a)?Nt(a,c=>c.test(o)):Ut(a,c=>c.test(o));let u;u=r.valueCallback?r.valueCallback(h):h,u=t.valueCallback?t.valueCallback(u):u;const l=e.slice(o.length);return{value:u,rest:l}}}function Ut(r,e){for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&e(r[t]))return t}function Nt(r,e){for(let t=0;t<r.length;t++)if(e(r[t]))return t}function Ft(r){return(e,t={})=>{const n=e.match(r.matchPattern);if(!n)return null;const s=n[0],i=e.match(r.parsePattern);if(!i)return null;let o=r.valueCallback?r.valueCallback(i[0]):i[0];o=t.valueCallback?t.valueCallback(o):o;const a=e.slice(s.length);return{value:o,rest:a}}}const Wt=/^(\d+)(th|st|nd|rd)?/i,Vt=/\d+/i,Bt={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Ht={any:[/^b/i,/^(a|c)/i]},$t={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Kt={any:[/1/i,/2/i,/3/i,/4/i]},zt={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Jt={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Xt={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Yt={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Gt={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Qt={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Zt={ordinalNumber:Ft({matchPattern:Wt,parsePattern:Vt,valueCallback:r=>parseInt(r,10)}),era:K({matchPatterns:Bt,defaultMatchWidth:"wide",parsePatterns:Ht,defaultParseWidth:"any"}),quarter:K({matchPatterns:$t,defaultMatchWidth:"wide",parsePatterns:Kt,defaultParseWidth:"any",valueCallback:r=>r+1}),month:K({matchPatterns:zt,defaultMatchWidth:"wide",parsePatterns:Jt,defaultParseWidth:"any"}),day:K({matchPatterns:Xt,defaultMatchWidth:"wide",parsePatterns:Yt,defaultParseWidth:"any"}),dayPeriod:K({matchPatterns:Gt,defaultMatchWidth:"any",parsePatterns:Qt,defaultParseWidth:"any"})},en={code:"en-US",formatDistance:kt,formatLong:_t,formatRelative:Et,localize:qt,match:Zt,options:{weekStartsOn:0,firstWeekContainsDate:1}};function tn(r,e,t){const n=ft(),s=(t==null?void 0:t.locale)??n.locale??en,i=2520,o=ne(r,e);if(isNaN(o))throw new RangeError("Invalid time value");const a=Object.assign({},t,{addSuffix:t==null?void 0:t.addSuffix,comparison:o});let h,u;o>0?(h=_(e),u=_(r)):(h=_(r),u=_(e));const l=St(u,h),c=(ke(u)-ke(h))/1e3,d=Math.round((l-c)/60);let m;if(d<2)return t!=null&&t.includeSeconds?l<5?s.formatDistance("lessThanXSeconds",5,a):l<10?s.formatDistance("lessThanXSeconds",10,a):l<20?s.formatDistance("lessThanXSeconds",20,a):l<40?s.formatDistance("halfAMinute",0,a):l<60?s.formatDistance("lessThanXMinutes",1,a):s.formatDistance("xMinutes",1,a):d===0?s.formatDistance("lessThanXMinutes",1,a):s.formatDistance("xMinutes",d,a);if(d<45)return s.formatDistance("xMinutes",d,a);if(d<90)return s.formatDistance("aboutXHours",1,a);if(d<Ce){const f=Math.round(d/60);return s.formatDistance("aboutXHours",f,a)}else{if(d<i)return s.formatDistance("xDays",1,a);if(d<Z){const f=Math.round(d/Ce);return s.formatDistance("xDays",f,a)}else if(d<Z*2)return m=Math.round(d/Z),s.formatDistance("aboutXMonths",m,a)}if(m=vt(u,h),m<12){const f=Math.round(d/Z);return s.formatDistance("xMonths",f,a)}else{const f=m%12,C=Math.trunc(m/12);return f<3?s.formatDistance("aboutXYears",C,a):f<9?s.formatDistance("overXYears",C,a):s.formatDistance("almostXYears",C+1,a)}}function nn(r,e){return tn(r,Date.now(),e)}function Pe(r,e,t){const n=r.slice();return n[12]=e[t],n}function Te(r,e){let t,n,s=e[12].expand.poster.username+"",i,o,a,h=e[6](e[12].created)+"",u,l,c,d,m=e[12].text+"",f,C,v,b,N;return{key:r,first:null,c(){t=y("div"),n=y("div"),i=z(s),o=E(),a=y("time"),u=z(h),l=E(),c=y("button"),d=y("div"),f=z(m),v=E(),this.h()},l(M){t=w(M,"DIV",{class:!0});var P=T(t);n=w(P,"DIV",{class:!0});var L=T(n);i=J(L,s),o=I(L),a=w(L,"TIME",{class:!0});var R=T(a);u=J(R,h),R.forEach(p),L.forEach(p),l=I(P),c=w(P,"BUTTON",{class:!0,"data-id":!0});var k=T(c);d=w(k,"DIV",{class:!0});var D=T(d);f=J(D,m),D.forEach(p),k.forEach(p),v=I(P),P.forEach(p),this.h()},h(){S(a,"class","text-xs text-gray-400 ml-2"),S(n,"class","font-bold text-primary"),S(d,"class","p-3 rounded-lg mt-1 text-left"),S(c,"class","w-full"),S(c,"data-id",C=e[12].id),S(t,"class","bg-gray-800 text-white"),this.first=t},m(M,P){O(M,t,P),g(t,n),g(n,i),g(n,o),g(n,a),g(a,u),g(t,l),g(t,c),g(c,d),g(d,f),g(t,v),b||(N=U(c,"click",e[4]),b=!0)},p(M,P){e=M,P&1&&s!==(s=e[12].expand.poster.username+"")&&ee(i,s),P&1&&h!==(h=e[6](e[12].created)+"")&&ee(u,h),P&1&&m!==(m=e[12].text+"")&&ee(f,m),P&1&&C!==(C=e[12].id)&&S(c,"data-id",C)},d(M){M&&p(t),b=!1,N()}}}function Oe(r){let e,t,n=`<a><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
				Edit</a>`,s,i,o,a='<svg class="fill-red-500" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z"></path></svg> <p class="text-red-500">Delete</p>',h,u;return{c(){e=y("ul"),t=y("li"),t.innerHTML=n,s=E(),i=y("li"),o=y("button"),o.innerHTML=a,this.h()},l(l){e=w(l,"UL",{class:!0,style:!0});var c=T(e);t=w(c,"LI",{"data-svelte-h":!0}),F(t)!=="svelte-13j5625"&&(t.innerHTML=n),s=I(c),i=w(c,"LI",{});var d=T(i);o=w(d,"BUTTON",{"data-svelte-h":!0}),F(o)!=="svelte-vbuk37"&&(o.innerHTML=a),d.forEach(p),c.forEach(p),this.h()},h(){S(e,"class","menu bg-base-200 w-56 rounded-box fixed"),G(e,"left",r[2].x+"px"),G(e,"top",r[2].y+"px")},m(l,c){O(l,e,c),g(e,t),g(e,s),g(e,i),g(i,o),h||(u=U(o,"click",r[7]),h=!0)},p(l,c){c&4&&G(e,"left",l[2].x+"px"),c&4&&G(e,"top",l[2].y+"px")},d(l){l&&p(e),h=!1,u()}}}function _e(r){let e,t='<div class="alert alert-error"><span>You can only delete your own posts!</span></div>';return{c(){e=y("div"),e.innerHTML=t,this.h()},l(n){e=w(n,"DIV",{class:!0,"data-svelte-h":!0}),F(e)!=="svelte-1ad7mvv"&&(e.innerHTML=t),this.h()},h(){S(e,"class","toast")},m(n,s){O(n,e,s)},d(n){n&&p(e)}}}function sn(r){let e,t=[],n=new Map,s,i,o,a=ye(r[0]);const h=c=>c[12].id;for(let c=0;c<a.length;c+=1){let d=Pe(r,a,c),m=h(d);n.set(m,t[c]=Te(m,d))}let u=r[1]&&Oe(r),l=r[3]&&_e();return{c(){e=y("div");for(let c=0;c<t.length;c+=1)t[c].c();s=E(),u&&u.c(),i=E(),l&&l.c(),o=se(),this.h()},l(c){e=w(c,"DIV",{class:!0});var d=T(e);for(let m=0;m<t.length;m+=1)t[m].l(d);d.forEach(p),s=I(c),u&&u.l(c),i=I(c),l&&l.l(c),o=se(),this.h()},h(){S(e,"class","posts mx-5")},m(c,d){O(c,e,d);for(let m=0;m<t.length;m+=1)t[m]&&t[m].m(e,null);O(c,s,d),u&&u.m(c,d),O(c,i,d),l&&l.m(c,d),O(c,o,d)},p(c,[d]){d&81&&(a=ye(c[0]),t=Be(t,d,h,1,c,a,n,e,Ve,Te,null,Pe)),c[1]?u?u.p(c,d):(u=Oe(c),u.c(),u.m(i.parentNode,i)):u&&(u.d(1),u=null),c[3]?l||(l=_e(),l.c(),l.m(o.parentNode,o)):l&&(l.d(1),l=null)},i:H,o:H,d(c){c&&(p(e),p(s),p(i),p(o));for(let d=0;d<t.length;d+=1)t[d].d();u&&u.d(c),l&&l.d(c)}}}function rn(r,e,t){let n=[],s,i=!1,o={x:0,y:0},a="",h=!1;function u(f){f.stopPropagation(),t(1,i=!i),t(2,o={x:f.clientX,y:f.clientY}),a=f.currentTarget.dataset.id||"",console.log("currentPostId",a)}function l(){t(1,i=!1)}async function c(){console.log("Deleting post",a);try{await j.collection("posts").delete(a)}catch(f){console.error("Error deleting post",f),t(3,h=!0),setTimeout(()=>{t(3,h=!1)},5e3)}}Le(async()=>{window.addEventListener("click",l);const f=await j.collection("posts").getList(1,50,{sort:"created",expand:"poster"});t(0,n=f.items),s=await j.collection("posts").subscribe("*",async({action:C,record:v})=>{if(C==="create"){const b=await j.collection("users").getOne(v.poster);v.expand={poster:b},t(0,n=[...n,v])}C==="delete"&&t(0,n=n.filter(b=>b.id!==v.id)),ie.set(!0)}),ie.set(!0)}),qe(()=>{window.removeEventListener("click",l),s()});function d(f){const C=new Date(f);return nn(C,{addSuffix:!0})}return[n,i,o,h,u,c,d,()=>c()]}class on extends oe{constructor(e){super(),ae(this,e,rn,sn,re,{})}}function an(r){let e,t,n,s,i,o,a='<svg xmlns="http://www.w3.org/2000/svg" height="48" viewBox="0 -960 960 960" width="48" class="fill-white"><path d="M120-160v-640l760 320-760 320Zm80-120 474-200-474-200v140l240 60-240 60v140Zm0 0v-400 400Z"></path></svg>',h,u;return{c(){e=y("div"),t=y("div"),n=y("form"),s=y("input"),i=E(),o=y("button"),o.innerHTML=a,this.h()},l(l){e=w(l,"DIV",{class:!0});var c=T(e);t=w(c,"DIV",{class:!0});var d=T(t);n=w(d,"FORM",{class:!0});var m=T(n);s=w(m,"INPUT",{placeholder:!0,type:!0,class:!0}),i=I(m),o=w(m,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),F(o)!=="svelte-3fk0vr"&&(o.innerHTML=a),m.forEach(p),d.forEach(p),c.forEach(p),this.h()},h(){S(s,"placeholder","Message"),S(s,"type","text"),S(s,"class","input input-bordered w-full max-w-x outline-none"),S(o,"type","submit"),S(o,"class",""),S(n,"class","flex items-center outline-none"),S(t,"class","p-2 bg-gray-700 mx-4 rounded-lg"),S(e,"class","gray-800")},m(l,c){O(l,e,c),g(e,t),g(t,n),g(n,s),B(s,r[0]),g(n,i),g(n,o),h||(u=[U(s,"input",r[2]),U(n,"submit",Ee(r[1]))],h=!0)},p(l,[c]){c&1&&s.value!==l[0]&&B(s,l[0])},i:H,o:H,d(l){l&&p(e),h=!1,pe(u)}}}function cn(r,e,t){let n;ge(r,ce,a=>t(3,n=a));let s;async function i(){if(!n)throw new Error("User is not logged in");const a={text:s,poster:n.id};await j.collection("posts").create(a),t(0,s="")}function o(){s=this.value,t(0,s)}return[s,i,o]}class ln extends oe{constructor(e){super(),ae(this,e,cn,an,re,{})}}function Me(r){let e,t,n,s,i,o;return t=new on({}),i=new ln({}),{c(){e=y("div"),he(t.$$.fragment),n=E(),s=y("div"),he(i.$$.fragment),this.h()},l(a){e=w(a,"DIV",{});var h=T(e);de(t.$$.fragment,h),h.forEach(p),n=I(a),s=w(a,"DIV",{class:!0});var u=T(s);de(i.$$.fragment,u),u.forEach(p),this.h()},h(){S(s,"class","sticky bottom-0")},m(a,h){O(a,e,h),fe(t,e,null),O(a,n,h),O(a,s,h),fe(i,s,null),o=!0},i(a){o||(W(t.$$.fragment,a),W(i.$$.fragment,a),o=!0)},o(a){X(t.$$.fragment,a),X(i.$$.fragment,a),o=!1},d(a){a&&(p(e),p(n),p(s)),me(t),me(i)}}}function un(r){let e,t,n,s,i,o,a,h='<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"/>',u;n=new ht({});let l=r[1]&&Me();return{c(){e=y("div"),t=y("div"),he(n.$$.fragment),s=E(),i=y("div"),l&&l.c(),o=E(),a=y("div"),a.innerHTML=h,this.h()},l(c){e=w(c,"DIV",{class:!0});var d=T(e);t=w(d,"DIV",{class:!0});var m=T(t);de(n.$$.fragment,m),m.forEach(p),s=I(d),i=w(d,"DIV",{class:!0});var f=T(i);l&&l.l(f),f.forEach(p),o=I(d),a=w(d,"DIV",{class:!0,"data-svelte-h":!0}),F(a)!=="svelte-8ow8e4"&&(a.innerHTML=h),d.forEach(p),this.h()},h(){S(t,"class","basis-1/4 bg-primary-content border-r border-gray-400/20 border-x-0 p-4"),S(i,"class","basis-1/2 bg-gray-800 overflow-y-auto overscroll-none"),S(a,"class","basis-1/4 bg-gray-900 p-4"),S(e,"class","flex flex-row h-screen sticky")},m(c,d){O(c,e,d),g(e,t),fe(n,t,null),g(e,s),g(e,i),l&&l.m(i,null),r[2](i),g(e,o),g(e,a),u=!0},p(c,[d]){c[1]?l?d&2&&W(l,1):(l=Me(),l.c(),W(l,1),l.m(i,null)):l&&(We(),X(l,1,1,()=>{l=null}),Fe())},i(c){u||(W(n.$$.fragment,c),W(l),u=!0)},o(c){X(n.$$.fragment,c),X(l),u=!1},d(c){c&&p(e),me(n),l&&l.d(),r[2](null)}}}function hn(r,e,t){let n;ge(r,ce,a=>t(1,n=a));let s;async function i(){await Ue(),s&&t(0,s.scrollTop=s.scrollHeight,s)}function o(a){Ne[a?"unshift":"push"](()=>{s=a,t(0,s)})}return ie.subscribe(a=>{a&&(i(),ie.set(!1))}),[s,n,o]}class gn extends oe{constructor(e){super(),ae(this,e,hn,un,re,{})}}export{gn as component,pn as universal};
